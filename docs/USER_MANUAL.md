# FRP Console 用户使用手册

## 目录

1. [系统简介](#一系统简介)
2. [快速开始](#二快速开始)
3. [功能使用指南](#三功能使用指南)
4. [常见问题](#四常见问题)
5. [故障排查](#五故障排查)

---

## 一、系统简介

### 1.1 什么是 FRP Console

FRP Console 是一个用于管理 FRP (Fast Reverse Proxy) 客户端的可视化管理控制台。它提供了直观的 Web 界面，帮助您轻松管理多个 FRPC 客户端实例。

### 1.2 主要功能

| 功能模块 | 说明 |
|---------|------|
| **仪表板** | 实时查看系统状态、客户端统计信息 |
| **客户端管理** | 创建、编辑、启动、停止、删除 FRPC 客户端 |
| **告警系统** | 自动检测客户端异常并发送邮件通知 |
| **审计日志** | 记录所有操作行为，便于追踪和审计 |
| **系统设置** | 修改密码、切换主题等个性化设置 |

### 1.3 系统要求

- **浏览器**: Chrome 90+, Firefox 88+, Edge 90+
- **推荐分辨率**: 1920x1080 或更高
- **网络**: 能够访问 FRP Console 服务器地址

---

## 二、快速开始

### 2.1 登录系统

1. 打开浏览器，访问 FRP Console 地址（如：`http://localhost:7600`）
2. 在登录页面输入用户名和密码
   - 默认用户名：`admin`
   - 初始密码：首次启动时系统自动生成的随机密码（请查看服务器日志）
3. 点击「登录」按钮进入系统

![登录页面](https://via.placeholder.com/800x400?text=Login+Page)

### 2.2 首次配置

首次登录后，建议立即执行以下操作：

1. **修改默认密码**
   - 进入「系统设置」→「修改密码」
   - 输入当前密码和新密码
   - 新密码要求：至少8位，包含大小写字母和数字

2. **配置邮件告警（可选）**
   - 如需接收告警通知，请配置 SMTP 邮件服务器
   - 在系统环境变量中设置相关参数

---

## 三、功能使用指南

### 3.1 仪表板

仪表板是系统的首页，展示了系统的整体运行状况。

#### 3.1.1 统计概览

- **总客户端数**: 系统中所有客户端的数量
- **运行中**: 当前正在运行的客户端数量
- **已停止**: 当前已停止的客户端数量
- **告警数**: 未解决的告警数量

#### 3.1.2 实时状态

- 客户端状态实时更新（通过 WebSocket）
- 显示最近的活动日志
- 快速跳转到各功能模块

### 3.2 客户端管理

客户端管理是系统的核心功能，用于管理所有的 FRPC 客户端。

#### 3.2.1 查看客户端列表

1. 点击左侧菜单「客户端管理」
2. 列表显示所有客户端的基本信息：
   - 名称
   - 服务器地址
   - 本地/远程端口
   - 运行状态
   - Always-On 模式
   - 操作按钮

#### 3.2.2 添加客户端

系统支持两种添加客户端的方式：

**方式一：表单模式（推荐新手）**

1. 点击「添加客户端」按钮
2. 选择「表单模式」
3. 填写以下信息：
   - **客户端名称**: 唯一标识，只能包含字母、数字、下划线和中文字符
   - **服务器地址**: FRP 服务器地址（如：`frp.example.com`）
   - **服务器端口**: FRP 服务器端口（默认：7000）
   - **Token**: 身份验证令牌
   - **用户标识**: 用户唯一标识
   - **本地端口**: 本地服务端口
   - **远程端口**: 远程映射端口
   - **Always-On**: 是否开启自动保持运行
4. 点击「创建」按钮

**方式二：粘贴配置（适合高级用户）**

1. 点击「添加客户端」按钮
2. 选择「粘贴配置」
3. 在文本框中粘贴 TOML 格式的 FRPC 配置文件
4. 输入客户端名称
5. 选择是否开启 Always-On
6. 点击「创建」按钮

配置示例：
```toml
[common]
server_addr = "frp.example.com"
server_port = 7000
tls_enable = false
user = "your_user_id"
token = "your_token"

[proxy]
type = tcp
local_ip = 127.0.0.1
local_port = 8080
remote_port = 8080
```

#### 3.2.3 编辑客户端信息

1. 在客户端列表中找到目标客户端
2. 点击「编辑」按钮
3. 修改需要更新的字段：
   - 客户端名称
   - 启用/禁用状态
   - Always-On 模式
4. 点击「保存」按钮

#### 3.2.4 编辑配置文件

1. 在客户端列表中找到目标客户端
2. 点击「配置」按钮
3. 在弹出的编辑器中修改 TOML 配置
4. 点击「保存」按钮

**注意事项：**
- 配置修改后需要重启客户端才能生效
- 系统会自动验证 TOML 格式，格式错误无法保存

#### 3.2.5 启动/停止/重启客户端

**启动客户端：**
1. 找到状态为「已停止」的客户端
2. 点击「启动」按钮
3. 等待状态变为「运行中」

**停止客户端：**
1. 找到状态为「运行中」的客户端
2. 点击「停止」按钮
3. 等待状态变为「已停止」

**重启客户端：**
1. 找到需要重启的客户端
2. 点击「重启」按钮
3. 系统会先停止再启动客户端

**强制重启：**
- 当客户端异常时，可使用「强制重启」功能
- 强制重启会忽略重启频率限制

#### 3.2.6 查看客户端日志

1. 在客户端列表中找到目标客户端
2. 点击「日志」按钮
3. 在弹出的日志窗口中查看实时日志
4. 日志窗口支持：
   - 自动滚动到最新内容
   - 手动刷新
   - 清空日志

#### 3.2.7 删除客户端

1. 在客户端列表中找到目标客户端
2. 点击「删除」按钮
3. 在确认对话框中点击「确认」

**注意事项：**
- 删除客户端会同时删除其配置文件和日志文件
- 删除操作不可恢复，请谨慎操作

#### 3.2.8 Always-On 模式说明

Always-On 模式是一种自动保持客户端运行的机制：

- **开启后**: 系统会定期检查客户端状态，如果客户端停止会自动重启
- **适用场景**: 需要 7x24 小时持续运行的服务
- **注意事项**: 
  - 手动停止的客户端不会自动重启
  - 短时间内多次重启失败会触发告警

### 3.3 告警系统

告警系统用于监控客户端异常状态并发送通知。

#### 3.3.1 查看告警列表

1. 点击左侧菜单「告警管理」
2. 列表显示所有告警信息：
   - 告警时间
   - 告警类型
   - 关联客户端
   - 告警消息
   - 解决状态

#### 3.3.2 告警类型说明

| 告警类型 | 说明 | 处理建议 |
|---------|------|---------|
| **客户端离线** | 客户端进程异常退出 | 检查客户端配置和服务器连接 |
| **重启失败** | 自动重启超过最大次数 | 检查配置文件是否正确 |
| **连接超时** | 无法连接到 FRP 服务器 | 检查网络连接和服务器状态 |
| **配置错误** | 配置文件格式错误 | 检查 TOML 配置语法 |

#### 3.3.3 过滤告警

1. 在告警列表页面，使用顶部的过滤器
2. 可按以下条件过滤：
   - 告警类型
   - 告警状态（已解决/未解决）
   - 时间范围

#### 3.3.4 标记告警为已解决

1. 在告警列表中找到目标告警
2. 点击「标记已解决」按钮
3. 告警状态将更新为「已解决」

### 3.4 审计日志

审计日志记录了系统中的所有操作行为。

#### 3.4.1 查看审计日志

1. 点击左侧菜单「审计日志」
2. 列表显示所有操作记录：
   - 操作时间
   - 操作用户
   - 操作类型
   - 操作详情
   - 客户端（如相关）

#### 3.4.2 操作类型说明

| 操作类型 | 说明 |
|---------|------|
| **CREATE** | 创建操作（如创建客户端） |
| **UPDATE** | 更新操作（如修改配置） |
| **DELETE** | 删除操作 |
| **START** | 启动客户端 |
| **STOP** | 停止客户端 |
| **RESTART** | 重启客户端 |
| **LOGIN** | 用户登录 |
| **LOGOUT** | 用户登出 |

#### 3.4.3 搜索审计日志

1. 在审计日志页面，使用搜索框
2. 支持按以下关键字搜索：
   - 用户名
   - 操作类型
   - 客户端名称
   - IP 地址

### 3.5 系统设置

#### 3.5.1 修改密码

1. 点击左侧菜单「系统设置」→「修改密码」
2. 输入当前密码
3. 输入新密码（需满足强度要求）
4. 确认新密码
5. 点击「保存」按钮

**密码强度要求：**
- 至少8个字符
- 包含至少一个大写字母
- 包含至少一个小写字母
- 包含至少一个数字

#### 3.5.2 切换主题

系统支持亮色和暗色两种主题：

1. 点击页面右上角的主题切换按钮
2. 选择「亮色模式」或「暗色模式」
3. 主题设置会自动保存

---

## 四、常见问题

### 4.1 登录相关

**Q: 忘记密码怎么办？**

A: 请联系系统管理员重置密码。管理员可以通过以下方式重置：
1. 停止 FRP Console 服务
2. 删除数据库文件中的用户记录（不推荐）
3. 或重新初始化数据库

**Q: 登录时提示"登录失败次数过多"？**

A: 系统启用了登录速率限制，连续5次登录失败后会锁定15分钟。请等待锁定时间结束后再尝试。

### 4.2 客户端相关

**Q: 客户端启动失败怎么办？**

A: 请按以下步骤排查：
1. 查看客户端日志，检查错误信息
2. 确认配置文件格式正确（TOML格式）
3. 检查服务器地址和端口是否可达
4. 确认 Token 和用户标识正确
5. 检查本地端口是否被占用

**Q: 客户端状态显示不正确？**

A: 尝试刷新页面或重启客户端。如果问题持续，可能是进程检测异常，请查看系统日志。

**Q: Always-On 客户端没有自动重启？**

A: 请检查：
1. Always-On 模式是否已开启
2. 客户端是否被手动停止（手动停止不会自动重启）
3. 重启频率是否超过限制（5分钟内最多3次）

### 4.3 告警相关

**Q: 没有收到告警邮件？**

A: 请检查：
1. SMTP 邮件服务器是否已正确配置
2. 邮件地址是否正确
3. 邮件是否被拦截到垃圾邮件箱
4. 查看系统日志中的邮件发送记录

**Q: 如何关闭告警通知？**

A: 目前系统不支持关闭告警，但可以通过标记已解决来管理告警列表。

### 4.4 系统相关

**Q: 系统响应慢怎么办？**

A: 建议：
1. 检查服务器资源使用情况（CPU、内存）
2. 减少同时运行的客户端数量
3. 清理过期的日志文件
4. 考虑升级服务器配置

**Q: 如何备份数据？**

A: FRP Console 的数据存储在以下位置：
- 数据库：`data/frpc.db`
- 配置文件：`clients/` 目录
- 日志文件：`logs/` 目录

建议定期备份这些目录。

---

## 五、故障排查

### 5.1 系统无法启动

**现象**: 访问 FRP Console 地址无响应

**排查步骤**:
1. 检查服务是否正在运行：`docker-compose ps` 或查看进程
2. 查看系统日志：`logs/frp-console.log`
3. 检查端口是否被占用：默认使用 7600 端口
4. 检查数据库文件是否损坏

### 5.2 客户端频繁重启

**现象**: 客户端启动后立即停止，然后自动重启

**排查步骤**:
1. 查看客户端日志，检查错误信息
2. 检查配置文件是否正确
3. 检查 FRP 服务器是否正常运行
4. 检查网络连接是否稳定
5. 暂时关闭 Always-On 模式进行手动调试

### 5.3 WebSocket 连接失败

**现象**: 仪表板状态不实时更新

**排查步骤**:
1. 检查浏览器控制台是否有 WebSocket 错误
2. 检查防火墙是否阻止 WebSocket 连接
3. 检查反向代理配置（如使用 Nginx）
4. 刷新页面重新连接

### 5.4 数据库错误

**现象**: 操作时报数据库相关错误

**排查步骤**:
1. 检查数据库文件权限
2. 检查磁盘空间是否充足
3. 查看数据库日志
4. 如损坏严重，考虑从备份恢复

---

## 附录

### A. 快捷键

| 快捷键 | 功能 |
|-------|------|
| `Ctrl + R` | 刷新页面 |
| `Esc` | 关闭弹窗 |
| `Enter` | 确认操作（在弹窗中） |

### B. 联系方式

如有问题，请通过以下方式联系：
- 项目地址：[GitHub Repository]
- 问题反馈：[Issues]

---

**文档版本**: v1.0  
**更新日期**: 2026-02-05  
**适用系统版本**: FRP Console v1.0.0